set(CMAKE_INCLUDE_CURRENT_DIR ON)

set(REACT_NATIVE_DESKTOP_EXTERNAL_MODULES_TYPE_NAMES ${REACT_NATIVE_DESKTOP_EXTERNAL_MODULES_TYPE_NAMES}
                                                     \"DesktopNotification\" PARENT_SCOPE)

set(REACT_NATIVE_DESKTOP_EXTERNAL_MODULES_SRC ${REACT_NATIVE_DESKTOP_EXTERNAL_MODULES_SRC}
                                              ${CMAKE_CURRENT_SOURCE_DIR}/desktopnotification.cpp PARENT_SCOPE)

include(${CMAKE_ROOT}/Modules/ExternalProject.cmake)

if (UNIX AND NOT APPLE)
  set(SnoreNotify_LIBPATHSUFFIX /x86_64-linux-gnu)
endif()

set(SnoreNotify_PREFIX ${CMAKE_CURRENT_BINARY_DIR}/SnoreNotify_ep-prefix/src/SnoreNotify_ep)
set(SnoreNotify_INCLUDE_DIR ${SnoreNotify_PREFIX}/include)
set(SnoreNotify_SHARED_LIB
    ${SnoreNotify_PREFIX}/lib${SnoreNotify_LIBPATHSUFFIX}/${CMAKE_SHARED_LIBRARY_PREFIX}snore-qt5${CMAKE_SHARED_LIBRARY_SUFFIX})
set(SnoreNotify_CMAKE_ARGS -DCMAKE_INSTALL_PREFIX=${SnoreNotify_PREFIX} -DBUILD_daemon=OFF -DBUILD_settings=OFF -DBUILD_snoresend=OFF -DCMAKE_MACOSX_RPATH=TRUE)

ExternalProject_Add(SnoreNotify_ep
  GIT_REPOSITORY https://github.com/status-im/snorenotify.git
  CMAKE_ARGS ${SnoreNotify_CMAKE_ARGS}
  BUILD_BYPRODUCTS ${SnoreNotify_SHARED_LIB}
  LOG_BUILD 1
  LOG_DOWNLOAD 1
)

set(REACT_NATIVE_DESKTOP_EXTERNAL_PROJECT_DEPS ${REACT_NATIVE_DESKTOP_EXTERNAL_PROJECT_DEPS} SnoreNotify_ep PARENT_SCOPE)

set(REACT_NATIVE_DESKTOP_EXTERNAL_MODULES_LIBS ${REACT_NATIVE_DESKTOP_EXTERNAL_MODULES_LIBS}
    ${SnoreNotify_SHARED_LIB} PARENT_SCOPE)

set(REACT_NATIVE_DESKTOP_EXTERNAL_MODULES_INCLUDE_DIRS ${REACT_NATIVE_DESKTOP_EXTERNAL_MODULES_INCLUDE_DIRS}
  ${SnoreNotify_INCLUDE_DIR} PARENT_SCOPE)

