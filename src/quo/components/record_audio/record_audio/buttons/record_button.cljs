(ns quo.components.record-audio.record-audio.buttons.record-button
  (:require
    [quo.components.buttons.button.view :as button]
    [quo.components.record-audio.record-audio.helpers :as helpers]
    [quo.components.record-audio.record-audio.style :as style]
    [react-native.core :as rn :refer [use-effect]]
    [react-native.reanimated :as reanimated]))

(defn f-record-button
  [recording? reviewing-audio?]
  (let [opacity        (reanimated/use-shared-value 1)
        show-animation #(helpers/set-value opacity 1)
        hide-animation #(helpers/set-value opacity 0)]
    (use-effect (fn []
                  (if (or @recording? @reviewing-audio?)
                    (hide-animation)
                    (show-animation)))
                [@recording? @reviewing-audio?])
    [reanimated/view {:style (style/record-button-container opacity)}
     [button/button
      {:type                :outline
       :size                32
       :accessibility-label :mic-button
       :icon-only?          true}
      :i/audio]]))
